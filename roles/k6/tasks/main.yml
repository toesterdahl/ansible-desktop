---
# First export key using apt-key
# apt-key list
# apt-key export <key id> > defaults/k6.gpg
# Where id is the alpha-numerical id in the list output..
#
- name: k6 - Add k6's official GPG Key
  become: true
  apt_key:
    id: C5AD17C747E3415A3642D57D77C6C491D6AC1D69
    file: "{{ role_path }}/defaults/k6.gpg"
    state: present

- name: k6 - Setup k6 stable repository
  become: true
  apt_repository:
    filename: "{{ k6_apt_file }}"
    repo: >-
      deb https://dl.k6.io/deb stable main

- name: Update apt cache
  become: true
  apt: update_cache=yes force_apt_get=yes

- name: k6 - Install
  become: true
  apt:
    name: "{{ item }}"
    state: latest
  loop:
    - k6

